steps:
  - block: "Release"
    prompt: "Fill out the details for release"
    fields: 
      - text: "Release Name"
        key: "release-name"
        hint: "Think of a cool name for this release"
      - text: "Changelog"
        key: "release-notes"
        required: false
        hint: "List of what's changed in this release"
      - select: "Type"
        key: "release-type"
        default: "beta"
        options:
        - label: "Beta"
          value: "beta"
        - label: "Stable"
          value: "stable"
  - label: "Release"
    command: 
      - "echo \"Release name: $(buildkite-agent meta-data get release-name)\""
    branches: "master"
    artifact_paths: 
  - label: "Test"
    command: "./gradlew testDebugUnitTest"
    branches: "master"
    artifact_paths: 
      - "app/**/*.xml"
      - "app/**/*.log"
  - label: "Build Debug"
    command: "./gradlew :app:assembleDebug"
    artifact_paths: "app/**/*.apk"
    branches: "master"
  - label: "Build Release"
    command: "./gradlew :app:assembleRelease"
    artifact_paths: "app/**/*.apk"
    branches: "master"
  - wait: ~